import{B as D,V as d,E as B,G as C,d as U,T as k,y as b,H as E,c as S,U as $,z as F,_ as A,i as w,g as o,b as a,t as c,I as y,w as i,q as I,r,o as G,x as L,p as T,h as N}from"./index-CfCwTioh.js";class q extends D{constructor(){super({exp:"",gender:""})}checkGender(t){const s=/^(Мужской|Женский)$/u;return d.checkField({context:t,regex:s,ref:"gender",errorMessage:"Некорректный пол"})}checkExp(t){const s=/^(100|[1-9]?[0-9])$/u;return d.checkField({context:t,regex:s,ref:"exp",errorMessage:"Некорректный стаж"})}}const H={updateUserData(e,t,s){try{B.put(C,e,t,s)}catch(n){n.message==="request_limit"&&s({error:{request_limit:["Превышен лимит запросов. Пожалуйста, попробуйте позже."]}})}}},M=U({name:"CarView",data:()=>({exp:"",gender:""}),components:{TitleComponent:k},methods:{...b(["checkLoggedStatus"]),validate(e){let t=this.userDataValidation.checkGender(this),s=this.userDataValidation.checkExp(this);t&&s&&e()},save(){this.validate(()=>{const e=parseInt(this.exp),t=this.gender=="Женский";H.updateUserData({exp:e,gender:t},s=>{E.setCookie("user",JSON.stringify(s.data),parseInt("2")),this.$toastr.info(s.message)},s=>{S(["exp","gender"],l=>{this.$toastr.error(l.pop())}).handle(s)})})},logout(){$.logout().then(()=>{this.checkLoggedStatus(),this.$router.go(0)})}},computed:{...F(["getLoggedStatus","getUserLogin","getUserData"]),getUserBalance(){return this.getUserData.balance}},created(){const e=this.getUserData;e.exp!=null&&(this.exp=e.exp.toString(),this.gender=e.gender?"Женский":"Мужской")},setup(){const e=new q;return{userDataValidation:e,errors:e.getErrors()}}}),p=e=>(T("data-v-2184624e"),e=e(),N(),e),j={class:"d-flex align-center mt-3"},z={class:"text-h6 me-1"},J=p(()=>a("p",null,"Баланс",-1)),O={class:"text-h5"},P=p(()=>a("p",{class:"text-h6 my-2"},"Персональные данные",-1));function W(e,t,s,n,g,l){const m=r("TitleComponent"),h=r("v-sheet"),v=r("v-divider"),_=r("v-select"),x=r("v-text-field"),f=r("v-btn"),V=r("v-form");return G(),w(I,null,[o(m,{title:"Профиль"}),a("div",j,[a("p",z,c(e.getUserLogin),1),a("a",{class:"text-subtitle-1 text-decoration-underline",onClick:t[0]||(t[0]=y(u=>e.logout(),["prevent"]))},"выйти")]),o(h,{class:"bg-balance pa-4 rounded my-3"},{default:i(()=>[J,a("b",O,c(e.getUserBalance)+" ₽",1)]),_:1}),o(v,{class:"my-4"}),a("div",null,[P,o(_,{modelValue:e.gender,"onUpdate:modelValue":t[1]||(t[1]=u=>e.gender=u),items:["Мужской","Женский"],"error-messages":e.errors.gender,label:"Пол водителя"},null,8,["modelValue","error-messages"]),o(V,null,{default:i(()=>[o(x,{label:"Стаж вождения","error-messages":e.errors.exp,modelValue:e.exp,"onUpdate:modelValue":t[2]||(t[2]=u=>e.exp=u)},null,8,["error-messages","modelValue"]),o(f,{block:"",flat:"",class:"save-button text-subtitle-1 mt-3",color:"blue-accent-2",onClick:t[3]||(t[3]=u=>e.save())},{default:i(()=>[L("Сохранить")]),_:1})]),_:1})])],64)}const Q=A(M,[["render",W],["__scopeId","data-v-2184624e"]]);export{Q as default};
